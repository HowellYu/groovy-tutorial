<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>65. Expando</title>
<link href="stylesheet.css" type="text/css" rel="stylesheet" />
</head>
<body>
<div id="leanpub-toc">
<h2></h2>
<ol class="toc has-parts">
<ul class='toc has-parts'>
  <li>
    <ul>
      <li>
        <a href='chap00.html#leanpub-auto-introduction'>Introduction</a>
      </li>
      <li>
        <a href='chap01.html#leanpub-auto-legal-notices'>Legal Notices</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap02.html#leanpub-auto-getting-started'><span class="section-number">I </span>Getting started</a>
    <ul>
      <li>
        <a href='chap03.html#leanpub-auto-installing-groovy'><span class="section-number">1. </span>Installing Groovy</a>
      </li>
      <li>
        <a href='chap04.html#leanpub-auto-your-first-lines-of-groovy'><span class="section-number">2. </span>Your first lines of Groovy</a>
      </li>
      <li>
        <a href='chap05.html#leanpub-auto-comments'><span class="section-number">3. </span>Comments</a>
      </li>
      <li>
        <a href='chap06.html#leanpub-auto-statements'><span class="section-number">4. </span>Statements</a>
      </li>
      <li>
        <a href='chap07.html#leanpub-auto-the-assert-statement'><span class="section-number">5. </span>The <code>assert</code> statement</a>
      </li>
      <li>
        <a href='chap08.html#leanpub-auto-reserved-words'><span class="section-number">6. </span>Reserved Words</a>
      </li>
      <li>
        <a href='chap09.html#leanpub-auto-packages'><span class="section-number">7. </span>Packages</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap10.html#leanpub-auto-variables'><span class="section-number">II </span>Variables</a>
    <ul>
      <li>
        <a href='chap11.html#leanpub-auto-declaring-variables'><span class="section-number">8. </span>Declaring Variables</a>
      </li>
      <li>
        <a href='chap12.html#leanpub-auto-data-types'><span class="section-number">9. </span>Data Types</a>
      </li>
      <li>
        <a href='chap13.html#leanpub-auto-objects'><span class="section-number">10. </span>Objects</a>
      </li>
      <li>
        <a href='chap14.html#leanpub-auto-booleans'><span class="section-number">11. </span>Booleans</a>
      </li>
      <li>
        <a href='chap15.html#leanpub-auto-numbers'><span class="section-number">12. </span>Numbers</a>
      </li>
      <li>
        <a href='chap16.html#leanpub-auto-strings'><span class="section-number">13. </span>Strings</a>
      </li>
      <li>
        <a href='chap17.html#leanpub-auto-collections'><span class="section-number">14. </span>Collections</a>
      </li>
      <li>
        <a href='chap18.html#leanpub-auto-arrays'><span class="section-number">15. </span>Arrays</a>
      </li>
      <li>
        <a href='chap19.html#leanpub-auto-ranges'><span class="section-number">16. </span>Ranges</a>
      </li>
      <li>
        <a href='chap20.html#leanpub-auto-regular-expressions'><span class="section-number">17. </span>Regular Expressions</a>
      </li>
      <li>
        <a href='chap21.html#leanpub-auto-data-types-1'><span class="section-number">18. </span>Data types</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap22.html#leanpub-auto-operators'><span class="section-number">III </span>Operators</a>
    <ul>
      <li>
        <a href='chap23.html#leanpub-auto-operators-1'><span class="section-number">19. </span>Operators</a>
      </li>
      <li>
        <a href='chap24.html#leanpub-auto-numeric-operators'><span class="section-number">20. </span>Numeric Operators</a>
      </li>
      <li>
        <a href='chap25.html#leanpub-auto-simple-assignment-operator'><span class="section-number">21. </span>Simple Assignment Operator</a>
      </li>
      <li>
        <a href='chap26.html#leanpub-auto-the-complement-operator'><span class="section-number">22. </span>The Complement Operator</a>
      </li>
      <li>
        <a href='chap27.html#leanpub-auto-equality-operators'><span class="section-number">23. </span>Equality Operators</a>
      </li>
      <li>
        <a href='chap28.html#leanpub-auto-arithmetic-operators'><span class="section-number">24. </span>Arithmetic operators</a>
      </li>
      <li>
        <a href='chap29.html#leanpub-auto-relational-operators'><span class="section-number">25. </span>Relational Operators</a>
      </li>
      <li>
        <a href='chap30.html#leanpub-auto-increment-and-decrement-operators'><span class="section-number">26. </span>Increment and Decrement Operators</a>
      </li>
      <li>
        <a href='chap31.html#leanpub-auto-conditional-operators'><span class="section-number">27. </span>Conditional Operators</a>
      </li>
      <li>
        <a href='chap32.html#leanpub-auto-bitwise-operators'><span class="section-number">28. </span>Bitwise Operators</a>
      </li>
      <li>
        <a href='chap33.html#leanpub-auto-compound-assignment-operators'><span class="section-number">29. </span>Compound Assignment Operators</a>
      </li>
      <li>
        <a href='chap34.html#leanpub-auto-string-operators-1'><span class="section-number">30. </span>String Operators</a>
      </li>
      <li>
        <a href='chap35.html#leanpub-auto-regular-expression-operators-1'><span class="section-number">31. </span>Regular Expression Operators</a>
      </li>
      <li>
        <a href='chap36.html#leanpub-auto-collection-operators-1'><span class="section-number">32. </span>Collection operators</a>
      </li>
      <li>
        <a href='chap37.html#leanpub-auto-object-operators-1'><span class="section-number">33. </span>Object Operators</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap38.html#leanpub-auto-control-flow-statements'><span class="section-number">IV </span>Control Flow Statements</a>
    <ul>
      <li>
        <a href='chap39.html#leanpub-auto-introduction-1'><span class="section-number">34. </span>Introduction</a>
      </li>
      <li>
        <a href='chap40.html#leanpub-auto-blocks'><span class="section-number">35. </span>Blocks</a>
      </li>
      <li>
        <a href='chap41.html#leanpub-auto-the-if-statement'><span class="section-number">36. </span>The <code>if</code> Statement</a>
      </li>
      <li>
        <a href='chap42.html#leanpub-auto-the-switch-statement'><span class="section-number">37. </span>The <code>switch</code> Statement</a>
      </li>
      <li>
        <a href='chap43.html#leanpub-auto-the-for-loop'><span class="section-number">38. </span>The <code>for</code> Loop</a>
      </li>
      <li>
        <a href='chap44.html#leanpub-auto-the-while-loop'><span class="section-number">39. </span>The <code>while</code> loop</a>
      </li>
      <li>
        <a href='chap45.html#leanpub-auto-branching-statements'><span class="section-number">40. </span>Branching statements</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap46.html#leanpub-auto-exceptions'><span class="section-number">V </span>Exceptions</a>
    <ul>
      <li>
        <a href='chap47.html#leanpub-auto-the-throwable-family'><span class="section-number">41. </span>The Throwable Family</a>
      </li>
      <li>
        <a href='chap48.html#leanpub-auto-common-exceptions'><span class="section-number">42. </span>Common Exceptions</a>
      </li>
      <li>
        <a href='chap49.html#leanpub-auto-anatomy-of-an-exception'><span class="section-number">43. </span>Anatomy of an Exception</a>
      </li>
      <li>
        <a href='chap50.html#leanpub-auto-try-catch-finally'><span class="section-number">44. </span>Try-Catch-Finally</a>
      </li>
      <li>
        <a href='chap51.html#leanpub-auto-how-much-should-we-try'><span class="section-number">45. </span>How Much Should We try?</a>
      </li>
      <li>
        <a href='chap52.html#leanpub-auto-causing-an-exception'><span class="section-number">46. </span>Causing an Exception</a>
      </li>
      <li>
        <a href='chap53.html#leanpub-auto-catching-errors'><span class="section-number">47. </span>Catching Errors</a>
      </li>
      <li>
        <a href='chap54.html#leanpub-auto-methods-and-exceptions'><span class="section-number">48. </span>Methods and Exceptions</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap55.html#leanpub-auto-methods'><span class="section-number">VI </span>Methods</a>
    <ul>
      <li>
        <a href='chap56.html#leanpub-auto-the-basics'><span class="section-number">49. </span>The Basics</a>
      </li>
      <li>
        <a href='chap57.html#leanpub-auto-parameters'><span class="section-number">50. </span>Parameters</a>
      </li>
      <li>
        <a href='chap58.html#leanpub-auto-default-values-for-parameters'><span class="section-number">51. </span>Default Values for Parameters</a>
      </li>
      <li>
        <a href='chap59.html#leanpub-auto-named-arguments'><span class="section-number">52. </span>Named Arguments</a>
      </li>
      <li>
        <a href='chap60.html#leanpub-auto-variable-arguments-varargs'><span class="section-number">53. </span>Variable Arguments (Varargs)</a>
      </li>
      <li>
        <a href='chap61.html#leanpub-auto-return-value'><span class="section-number">54. </span>Return value</a>
      </li>
      <li>
        <a href='chap62.html#leanpub-auto-throwing-an-exception'><span class="section-number">55. </span>Throwing an exception</a>
      </li>
      <li>
        <a href='chap63.html#leanpub-auto-documenting-a-method'><span class="section-number">56. </span>Documenting a method</a>
      </li>
      <li>
        <a href='chap64.html#leanpub-auto-techniques'><span class="section-number">57. </span>Techniques</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap65.html#leanpub-auto-closures'><span class="section-number">VII </span>Closures</a>
    <ul>
      <li>
        <a href='chap66.html#leanpub-auto-introducing-closures'><span class="section-number">58. </span>Introducing Closures</a>
      </li>
      <li>
        <a href='chap67.html#leanpub-auto-parameters-1'><span class="section-number">59. </span>Parameters</a>
      </li>
      <li>
        <a href='chap68.html#leanpub-auto-returning-values'><span class="section-number">60. </span>Returning Values</a>
      </li>
      <li>
        <a href='chap69.html#leanpub-auto-closures-as-method-parameters'><span class="section-number">61. </span>Closures as Method Parameters</a>
      </li>
      <li>
        <a href='chap70.html#leanpub-auto-loops-and-closures'><span class="section-number">62. </span>Loops and closures</a>
      </li>
      <li>
        <a href='chap71.html#leanpub-auto-useful-methods-that-use-closures'><span class="section-number">63. </span>Useful Methods That Use Closures</a>
      </li>
      <li>
        <a href='chap72.html#leanpub-auto-closure-scope'><span class="section-number">64. </span>Closure scope</a>
      </li>
    </ul>
  </li>
  <li>
    <a href='chap73.html#leanpub-auto-object-oriented-programming'><span class="section-number">VIII </span>Object-oriented programming</a>
    <ul>
      <li>
        <a href='chap74.html#leanpub-auto-expando'><span class="section-number">65. </span>Expando</a>
      </li>
      <li>
        <a href='chap75.html#leanpub-auto-the-basics-of-oo'><span class="section-number">66. </span>The basics of OO</a>
      </li>
      <li>
        <a href='chap76.html#leanpub-auto-colophon'>Colophon</a>
      </li>
    </ul>
  </li>
</ul>

</ol>
</div>
<div id="leanpub-main">
<h2 id="leanpub-auto-expando"><span class="section-number">65. </span>Expando</h2>

<table class="information sidebarish">
  <tbody>
    <tr><td class="sidebar-icon">
      <img class="sidebar-image" src="images/leanpub_info-circle.png" alt="information" width="50px" /></td>
    <td>
      <p>The Expando class lets you create objects on the fly. </p>

    </td>
  </tr>
  </tbody>
</table><p>Before getting stuck into formal object definition, let’s take a look at the <code>Expando</code> class that ships with Groovy. Expando provides a very flexible way to construct an object on the fly.</p>

<p>In the example below the <code>monster</code> variable is dynamically assigned a set of fields and methods (through the use of closures).</p>

<div class="code-block">
  <p class="codeblock-title">The Expando Monster</p>

  <hr /><div class="highlight"><pre><code class="n">def</code> <code class="n">monster</code> <code class="o">=</code> <code class="n">new</code> <code class="n">Expando</code><code class="p">()</code>

<code class="c1">//Let's add some properties</code>
<code class="n">monster</code><code class="p">.</code><code class="n">name</code> <code class="o">=</code> <code class="err">'</code><code class="n">Dr</code> <code class="n">Frankensteins</code> <code class="n">Monster</code><code class="err">'</code>
<code class="n">monster</code><code class="p">.</code><code class="n">owner</code> <code class="o">=</code> <code class="err">'</code><code class="n">Dr</code> <code class="n">Frankenstein</code><code class="err">'</code>
<code class="n">monster</code><code class="p">.</code><code class="n">height</code> <code class="o">=</code> <code class="mi">8</code>

<code class="c1">//Add some closures (methods)</code>
<code class="n">monster</code><code class="p">.</code><code class="n">getOwner</code> <code class="o">=</code> <code class="p">{</code><code class="n">owner</code><code class="p">}</code>
<code class="n">monster</code><code class="p">.</code><code class="n">getName</code> <code class="o">=</code> <code class="p">{</code><code class="n">name</code><code class="p">}</code>
<code class="n">monster</code><code class="p">.</code><code class="n">getHeight</code> <code class="o">=</code> <code class="p">{</code><code class="n">height</code><code class="p">}</code>

<code class="n">monster</code><code class="p">.</code><code class="n">scareVillage</code> <code class="o">=</code> <code class="p">{</code> <code class="n">village</code> <code class="o">-&gt;</code>
    <code class="n">println</code> <code class="s">"Look out $village here comes $name!"</code>
<code class="p">}</code>

<code class="n">monster</code><code class="p">.</code><code class="n">scareVillage</code><code class="p">(</code><code class="err">'</code><code class="n">Darmstadt</code><code class="err">'</code><code class="p">)</code>
</pre></div>

  <hr /></div>

<p>The <code>monster</code> Expando looks to be acting in a manner similar to a Map but it gives us more functionality. Whilst the properties can be assigned to an Expando instance in the same way as a Map, the addition of a closure illustrates the difference. In the example below the use of a Map to define the <code>vampire</code> variable demonstrates that the <code>scareVillage</code> can’t rely on an instance field (<code>name</code>) so must refer back to the <code>vampire</code> map:</p>

<div class="code-block">
  <p class="codeblock-title">The Vampire Map</p>

  <hr /><div class="highlight"><pre><code class="n">def</code> <code class="n">vampire</code> <code class="o">=</code> <code class="p">[</code><code class="o">:</code><code class="p">]</code>
<code class="n">vampire</code><code class="p">.</code><code class="n">name</code> <code class="o">=</code> <code class="err">'</code><code class="n">Dracula</code><code class="err">'</code>

<code class="n">vampire</code><code class="p">.</code><code class="n">scareVillage</code> <code class="o">=</code> <code class="p">{</code> <code class="n">village</code> <code class="o">-&gt;</code>
    <code class="n">println</code> <code class="s">"Look out $village here comes $vampire.name!"</code>
<code class="p">}</code>

<code class="n">vampire</code><code class="p">.</code><code class="n">scareVillage</code><code class="p">(</code><code class="err">'</code><code class="n">London</code><code class="err">'</code><code class="p">)</code>
</pre></div>

  <hr /></div>

<p>By using the <code>Expando</code> class instead of a <code>Map</code>, the instance fields can be accessed.</p>

<h3 id="leanpub-auto-using-expando-with-csv-data">Using Expando with CSV data</h3>

<p>Expando can be useful when we want to consume data from a source (such as a file) and manipulate it as an object. One such example is an application that reads a comma-separated file (a CSV) that contains a header row and multiple subsequent data rows. The header rows tell us the fields in our data objects and we can start to throw in some methods to help handle our data.</p>

<p>I’ll start with a full listing of a script that accepts CSV data (I’ll just use a String but it could be from a file) about various contacts. Expando will help me then produce a <a href="https://en.wikipedia.org/wiki/VCard">vCard</a> for each contact. Take a read of the full listing and we’ll then break it down into easier chunks.</p>

<div class="code-block">
  <p class="codeblock-title">The full CSV example</p>

  <hr /><div class="highlight"><pre><code class="c1">//This is a basic CSV (Comma-separated file)  described as a string</code>
<code class="n">def</code> <code class="k">table</code> <code class="o">=</code> <code class="p">'''</code>\
<code class="n">name</code><code class="p">,</code><code class="n">email</code><code class="p">,</code><code class="n">phone</code>
<code class="n">Fred</code><code class="p">,</code><code class="n">fred</code><code class="p">@</code><code class="n">email</code><code class="p">.</code><code class="n">com</code><code class="p">,</code><code class="mh">555</code><code class="o">-</code><code class="mh">678345</code>
<code class="n">Alex</code><code class="p">,</code><code class="n">alex</code><code class="p">@</code><code class="n">email</code><code class="p">.</code><code class="n">com</code><code class="p">,</code><code class="mh">555</code><code class="o">-</code><code class="mh">987123</code>
<code class="n">Simon</code><code class="p">,</code><code class="n">simon</code><code class="p">@</code><code class="n">example</code><code class="p">.</code><code class="n">com</code><code class="p">,</code><code class="mh">555</code><code class="o">-</code><code class="mh">567321</code>
<code class="p">'''</code>

<code class="c1">//Read the CSV in and break it up by linebreaks</code>
<code class="n">def</code> <code class="n">csv</code> <code class="o">=</code> <code class="k">table</code><code class="p">.</code><code class="n">tokenize</code><code class="p">()</code>

<code class="c1">//Extract the first row - it contains the headers (field names)</code>
<code class="n">header</code> <code class="o">=</code> <code class="n">csv</code><code class="p">[</code><code class="mh">0</code><code class="p">].</code><code class="n">tokenize</code><code class="p">(</code><code class="sc">','</code><code class="p">)</code>
<code class="n">csv</code><code class="p">.</code><code class="n">remove</code><code class="p">(</code><code class="mh">0</code><code class="p">)</code>

<code class="n">def</code> <code class="n">contactList</code> <code class="o">=</code> <code class="p">[]</code>

<code class="k">for</code> <code class="p">(</code><code class="n">row</code> <code class="n">in</code> <code class="n">csv</code><code class="p">)</code> <code class="p">{</code>
    
    <code class="n">Expando</code> <code class="n">contact</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Expando</code><code class="p">()</code>
    
    <code class="c1">//Now setup the contact class with field names based on the header</code>
    <code class="n">row</code><code class="p">.</code><code class="n">tokenize</code><code class="p">(</code><code class="sc">','</code><code class="p">).</code><code class="n">eachWithIndex</code> <code class="p">{</code> <code class="n">key</code><code class="p">,</code> <code class="n">value</code> <code class="o">-&gt;</code>
       <code class="n">contact</code><code class="p">.</code><code class="n">setProperty</code> <code class="n">header</code><code class="p">[</code><code class="n">value</code><code class="p">],</code> <code class="n">key</code>
    <code class="p">}</code>
    
    <code class="n">contact</code><code class="p">.</code><code class="n">getVCard</code> <code class="o">=</code> <code class="p">{</code>
        <code class="s">"""BEGIN:VCARD</code>
        <code class="nl">VERSION:</code><code class="mf">4.0</code>
        <code class="nl">N:</code><code class="err">$</code><code class="n">name</code>
        <code class="nl">EMAIL:</code><code class="err">$</code><code class="n">email</code>
        <code class="no">TEL</code><code class="p">;</code><code class="no">TYPE</code><code class="o">=</code><code class="n">work</code><code class="p">,</code><code class="n">voice</code><code class="p">;</code><code class="no">VALUE</code><code class="o">=</code><code class="nl">uri:tel:</code><code class="err">$</code><code class="n">phone</code>
        <code class="nl">END:</code><code class="no">VCARD</code><code class="s">"""</code>
    <code class="p">}</code>
    <code class="n">contactList</code> <code class="o">&lt;&lt;</code> <code class="n">contact</code>
<code class="p">}</code>

<code class="k">for</code> <code class="p">(</code><code class="n">contact</code> <code class="n">in</code> <code class="n">contactList</code><code class="p">)</code> <code class="p">{</code>
    <code class="n">println</code> <code class="n">contact</code><code class="p">.</code><code class="n">getVCard</code><code class="p">()</code>
<code class="p">}</code>
</pre></div>

  <hr /></div>

<p>The first bit of code just sets up a sample CSV data table:</p>

<div class="code-block">
<div class="highlight"><pre><code class="n">def</code> <code class="n">table</code> <code class="o">=</code> <code class="err">'''</code>\
<code class="n">name</code><code class="p">,</code><code class="n">email</code><code class="p">,</code><code class="n">phone</code>
<code class="n">Fred</code><code class="p">,</code><code class="n">fred</code><code class="err">@</code><code class="n">email</code><code class="p">.</code><code class="n">com</code><code class="p">,</code><code class="mi">555</code><code class="o">-</code><code class="mi">678345</code>
<code class="n">Alex</code><code class="p">,</code><code class="n">alex</code><code class="err">@</code><code class="n">email</code><code class="p">.</code><code class="n">com</code><code class="p">,</code><code class="mi">555</code><code class="o">-</code><code class="mi">987123</code>
<code class="n">Simon</code><code class="p">,</code><code class="n">simon</code><code class="err">@</code><code class="n">example</code><code class="p">.</code><code class="n">com</code><code class="p">,</code><code class="mi">555</code><code class="o">-</code><code class="mi">567321</code>
<code class="err">'''</code>
</pre></div>

</div>

<p>The handy <code>tokenize</code> method is used to break the CSV data into individual rows. The first row is actually a header row and we perform another <code>tokenize</code> to extract each header item (field) and then remove the header row from the data table:</p>

<div class="code-block">
<div class="highlight"><pre><code class="n">def</code> <code class="n">csv</code> <code class="o">=</code> <code class="n">table</code><code class="p">.</code><code class="n">tokenize</code><code class="p">()</code>
<code class="n">header</code> <code class="o">=</code> <code class="n">csv</code><code class="p">[</code><code class="mi">0</code><code class="p">].</code><code class="n">tokenize</code><code class="p">(</code><code class="sc">','</code><code class="p">)</code>
<code class="n">csv</code><code class="p">.</code><code class="n">remove</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
</pre></div>

</div>

<p>A <code>contactList</code> is then defined - this will hold our list of contacts:</p>

<div class="code-block">
<div class="highlight"><pre><code class="n">def</code> <code class="n">contactList</code> <code class="o">=</code> <code class="p">[]</code>
</pre></div>

</div>

<p>The code now iterates through the data table.  For each row, an instance of <code>Expando</code> is declared:</p>

<div class="code-block">
<div class="highlight"><pre><code class="n">Expando</code> <code class="n">contact</code> <code class="o">=</code> <code class="n">new</code> <code class="n">Expando</code><code class="p">()</code>
</pre></div>

</div>

<p><code>tokenize</code> is again used to separate each field in the row. The <code>eachWithIndex</code> method passes the field value and its index into the closure’s key and value parameters respectively. I use the index to work out the field name in <code>header</code> and set the value as the field from the row:</p>

<div class="code-block">
<div class="highlight"><pre><code class="c1">//Now setup the contact class with field names based on the header</code>
<code class="n">row</code><code class="p">.</code><code class="n">tokenize</code><code class="p">(</code><code class="sc">','</code><code class="p">).</code><code class="n">eachWithIndex</code> <code class="p">{</code> <code class="n">key</code><code class="p">,</code> <code class="n">value</code> <code class="o">-&gt;</code>
	<code class="n">contact</code><code class="p">.</code><code class="n">setProperty</code> <code class="n">header</code><code class="p">[</code><code class="n">value</code><code class="p">],</code> <code class="n">key</code>
<code class="p">}</code>
</pre></div>

</div>

<table class="tip sidebarish">
  <tbody>
    <tr><td class="sidebar-icon">
      <img class="sidebar-image" src="images/leanpub_key.png" alt="tip" width="50px" /></td>
    <td>
      <h3 id="leanpub-auto-another-way-to-set-the-property">Another way to set the property</h3>
  <p>Instead of using <code>setProperty</code> I could have used Groovy’s ability to use string interpolation to access a method/property:
	<code>contact."${header[value]}" = key</code></p>

    </td>
  </tr>
  </tbody>
</table><p>The <code>getVCard</code> closure is then added to the contact - this will construct a vCard for use in other systems:</p>

<div class="code-block">
<div class="highlight"><pre><code class="n">contact</code><code class="p">.</code><code class="n">getVCard</code> <code class="o">=</code> <code class="p">{</code>
    <code class="s">"""BEGIN:VCARD</code>
    <code class="nl">VERSION:</code><code class="mf">4.0</code>
    <code class="nl">N:</code><code class="err">$</code><code class="n">name</code>
    <code class="nl">EMAIL:</code><code class="err">$</code><code class="n">email</code>
    <code class="n">TEL</code><code class="p">;</code><code class="n">TYPE</code><code class="o">=</code><code class="n">work</code><code class="p">,</code><code class="n">voice</code><code class="p">;</code><code class="n">VALUE</code><code class="o">=</code><code class="n">uri</code><code class="o">:</code><code class="n">tel</code><code class="o">:</code><code class="err">$</code><code class="n">phone</code>
    <code class="nl">END:</code><code class="n">VCARD</code><code class="s">"""</code>
<code class="p">}</code>
<code class="n">contactList</code> <code class="o">&lt;&lt;</code> <code class="n">contact</code>
</pre></div>

</div>

<p>Once each row has been consumed we can display our <code>contactList</code>:</p>

<div class="code-block">
<div class="highlight"><pre><code class="k">for</code> <code class="p">(</code><code class="n">contact</code> <code class="n">in</code> <code class="n">contactList</code><code class="p">)</code> <code class="p">{</code>
    <code class="n">println</code> <code class="n">contact</code><code class="p">.</code><code class="n">getVCard</code><code class="p">()</code>
<code class="p">}</code>
</pre></div>

</div>
</div>
</body>
</html>
